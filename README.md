# 维修师智能设计工坊 (Smart Poster AutoGen)

## 📌 项目简介

本项目是一个自动化设计工具，旨在帮助设计团队高效地批量生成“维修师海报”。通过智能解析 Excel 数据并自动操控 Photoshop，能够将数小时的手工设计工作缩短至几分钟。

主要包含两个核心流程：
1. **Excel 数据清洗**：智能识别和提取原始表格中的姓名、门店、文案、匠龄等信息，自动排版并生成标准化的数据源。
2. **PSD 批量生成**：读取清洗后的数据，控制 Photoshop 自动填充图层内容（文字、排版），并批量导出 PSD 源文件。

## 🚀 核心功能

*   **智能数据解析**：自动识别 Excel 表头，支持模糊匹配（智能查找“姓名”、“门店”、“文案”等列）。
*   **文案结构化提取**：从非结构化的长文本中自动提取“匠人独白”、“小标题”及对应“描述”，支持多种分隔符识别。
*   **文本自动清洗**：自动去除多余空格、修正标点符号、规范数字格式，确保排版美观。
*   **Photoshop 自动化**：通过 COM 接口直接控制 PS，支持文本内容替换、图层查找（包括图层组内的图层）、自动调整文本框高度。
*   **UI 交互界面**：提供友好的图形界面，支持文件拖拽操作，实时显示处理日志和状态。
*   **数据核对报告**：在清洗完成后自动生成 `.txt` 核对单，方便人工二次确认。

## 🛠️ 环境依赖

由于本项目需要调用本地 Photoshop，**仅支持 Windows 系统**。

### 软件要求
*   **操作系统**: Windows 10/11
*   **Photoshop**: 已安装 Adobe Photoshop (建议 CC 2019 及以上版本)
*   **Python**: Python 3.8 及以上

### Python 库依赖
请在终端中运行以下命令安装所需依赖：

```bash
pip install pandas openpyxl pywin32 tkinterdnd2
```

> 注意：`tkinter` 通常随 Python 安装自带。如果提示找不到，请重新安装 Python 并确选上了 tcl/tk 组件。

## 📂 文件结构说明

```
Smart_Poster_AutoGen/
├── excel_cleaner_tool.py    # [核心] 主程序代码 (UI界面 + 业务逻辑)
├── 启动维修师智能设计工坊.bat          # [入口] 双击即可运行程序的启动脚本
├── model/                   # [资源] 存放 PSD 模板文件
│   └── 维修师-模板.psd       # 默认使用的设计模板
├── data/                    # [数据] 建议存放原始 Excel 数据的位置
├── output_psds/             # [输出] 生成的 PSD 文件默认保存目录
├── requirements.txt         # (可选) 依赖列表
└── README.md                # 项目说明文档
```

## 📖 使用指南

### 第一步：准备工作
1. 确保 Photoshop 已打开（建议提前打开以提高响应速度）。
2. 双击运行 `启动维修师智能设计工坊.bat`。

### 第二步：数据清洗
1. 在软件界面 **“步骤 1”** 区域，拖拽 **原始 Excel 文件** 到指定框内。
2. 点击 **“清洗数据并导出 Excel”** 按钮。
3. 程序会自动生成一个 `_清洗版.xlsx` 文件和一个 `_数据核对单.txt` 文件，并自动打开核对单供您检查。

### 第三步：批量生成
1. 确认 **“步骤 2”** 区域已自动加载刚才生成的 `_清洗版.xlsx` 文件（也可手动拖拽）。
2. 观察下方状态栏，确保 **“数据源”** 和 **“模板”** 均显示 ✅ 绿色就绪状态。
3. 点击 **“启动 Photoshop 批量生成”** 按钮。
4. 程序将自动在后台操作 Photoshop，生成的 PSD 文件将保存在 `output_psds` 文件夹中。

## ⚠️ 注意事项

1. **Excel 格式**：原始表格最好包含“姓名”、“门店”、“文案”（或“匠人独白”）等列。程序有智能容错机制，但标准化的表头能提高识别准确率。
2. **Photoshop 弹窗**：运行过程中请勿手动点击 Photoshop 界面，以免打断自动化脚本。如果 PS 弹出“字体缺失”或“更新文本图层”的提示，请先手动处理并关闭弹窗。
3. **图层命名**：PSD 模板中的图层名称必须与代码中的映射保持一致（如`姓名`、`门店`、`匠人独白`、`标题1`等），且尽量不要更改图层结构（虽然程序支持递归查找图层组）。

## 📝 版本历史

*   **v1.0**: 引入全新的 GUI 界面，增加数据清洗功能，优化文本提取算法，支持 Win32 COM 自动化。
